# Neural Network Signal Processing Tutorials

Download this directory and execute the `.py` files.

## Activations

`class Activations(network, input)`

Holds the activation pattern generated in a neural network

#### Parameters

`network: torch.nn.Module` Pytroch neural network.

`input: torch.tensor`
A valid single input to the network. For later computations make sure to pass a single input, i.e. `batch_size = 1`.

#### Attributes

`layernames: [String]` Holds the names of the children modules, i.e. layer names, of the network in a list.

`layerdescriptions: [torch.nn]` Holds the children modules, i.e. layer types and specifications, of the network in a list.

`layeractivations: [torch.tensor]` Holds the activations of every child module, i.e. values of the activation pattern, in a list.

#### Methods

| |Description|
|---|---|
|`to_vector()`| Reshape the `layeractivations` into a vector and return them as `list`.|

`to_activations(signal)` Create object `Activatitions` like `self` but with `layeractivations` according to vector `signal: list` or `signal: ndarray`. Returns `Activations`.

## NNGraph

`class NNGraph(activations, INCL=True)`

Directed graph representing in the computational graph structure of a Pytorch neural network.

#### Parameters

`activations: Activations`
Pass any sample activation pattern generated by the network under observation. The resulting `NNGraph` is independent of the activation values contained in the specific activation pattern, i.e. `activation.layeractivations`.

`INCL: boolean`
Optional parameter. If set to `True`, it includes edges in the NNGraph even if the weight of the edge in the neural network is `0`. If set to `False`, only edges with weight unequal to `0` are added to the graph. Especially, `INCL = False` will only have one incoming edge per activation in  a `torch.nn.MaxPool` layer.


#### Attributes

`inv_F: scipy.sparse.tril(A, format='csr')`
Inverse Fourier Transform matrix w.r.t. [[1]](https://arxiv.org/pdf/2012.04358.pdf). Is `None` until the first invocation of `NNGraph.transform(activations, type='standard')` or can be explicitly assigned by calling `NNGraph.compute_transformer(type='standard')`.

`lu_piv: ndarray, ndarray`
LU-decomposition of the inverse Fourier Transform matrix w.r.t. [[2]](https://arxiv.org/pdf/1211.0053.pdf). Is `None` until the first invocation of `NNGraph.transform(activations, type='laplacian')` or can be explicitly assigned by calling `NNGraph.compute_transformer(type='laplacian')`.


#### Methods

`compute_transformer(type='standard')` If `type='standard'` it computes the inverse Fourier Transform matrix w.r.t. [[1]](https://arxiv.org/pdf/2012.04358.pdf). Returns [`scipy.sparse.tril(A, format='csr')`](https://docs.scipy.org/doc/scipy/reference/generated/scipy.sparse.tril.html).
If `type='laplacian'` it computes the inverse Fourier Transform matrix w.r.t. [[2]](https://arxiv.org/pdf/1211.0053.pdf). Returns [`lu, piv: ndarray, ndarray`](https://docs.scipy.org/doc/scipy/reference/generated/scipy.linalg.lu_factor.html).

`transform(activations, type='standard')` Compute the Fourier coefficients, or spectrum, of the `activations`. If `type='standard'` the Fourer coefficient w.r.t. [[1]](https://arxiv.org/pdf/2012.04358.pdf) are computed. If `type='laplacian'` the Fourer coefficient w.r.t. [[2]](https://arxiv.org/pdf/1211.0053.pdf) are computed. Returns `Activations`.

`node_id(node)` Return the index of a node in the `NNGraph` in the total order of all nodes. Returns `int`.

## OutputLoader

`class OutputLoader`

Store and load intermediate results. Especially useful for storing `NNGraph` and `Transformers` since their computations take long and they can be used to transform multiple `Activations`.

#### Methods

`save(obj, path)` Store python object like `Activations` or `NNGrpah` at the specified `path: String`. Returns `None`.

`load(path)` Load python object like `Activations` or `NNGrpah` at the specified `path: String`. Returns `object`.


## References
[1]
Markus Püschel, Bastian Seifert, and Chris Wendler. Discrete signal processing on meet/join lattices. IEEE Transactions on Signal Processing, 2021.

[2]
David I Shuman, Sunil K Narang, Pascal Frossard, Antonio Ortega, and Pierre Vandergheynst. The emerging field of signal processing on graphs: Extending high-dimensional data analysis to networks and other irregular domains. IEEE signal processing magazine, 30(3):83–98, 2013.
